name: Validate Culinary Command

on:
    pull_request:
        branches: [ "main" ]

permissions:
  id-token: write
  contents: read


jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
        - name: Checkout
          uses: actions/checkout@v4

        - name: Cache .NET packages
          uses: actions/cache@v4
          with:
            path: |
              ~/.nuget/packages
            key: ${{ runner.os }}-nuget-${{ hashFiles('**/*.csproj') }}
            restore-keys: |
              ${{ runner.os }}-nuget-

        - name: Setup .NET
          uses: actions/setup-dotnet@v4
          with:
            dotnet-version: 9.0.x

        - name: Setup Node.js for Playwright CLI
          uses: actions/setup-node@v4
          with:
            node-version: 20

        - name: Setup Playwright
          uses: microsoft/playwright-github-action@v1
          with:
            install-deps: true
            browsers: chromium,firefox,webkit

        - name: Run Culinary Command xUnit tests
          run: |
            dotnet test CulinaryCommandApp/CulinaryCommand.sln

