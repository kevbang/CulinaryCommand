<div class="tab-pane active">
    <h4 class="mb-4">
        <i class="fas fa-lock me-2"></i>Security Settings
    </h4>

    <EditForm Model="@securityModel" OnValidSubmit="@HandleSecuritySubmit">
        <div class="mb-3">
            <label for="currentPassword" class="form-label">Current Password</label>
            <div class="password-input-container">
                <InputText id="currentPassword"
                           type="@(showCurrentPassword ? "text" : "password")"
                           class="form-control"
                           @bind-Value="securityModel.CurrentPassword"
                           placeholder="Enter current password" />
                <button type="button" class="password-toggle-btn"
                        @onclick="@(() => showCurrentPassword = !showCurrentPassword)">
                    <i class="fas @(showCurrentPassword ? "fa-eye-slash" : "fa-eye")"></i>
                </button>
            </div>
        </div>

        <div class="mb-3">
            <label for="newPassword" class="form-label">New Password</label>
            <div class="password-input-container">
                <InputText id="newPassword"
                           type="@(showNewPassword ? "text" : "password")"
                           class="form-control"
                           @bind-Value="securityModel.NewPassword"
                           placeholder="Enter new password" />
                <button type="button" class="password-toggle-btn"
                        @onclick="@(() => showNewPassword = !showNewPassword)">
                    <i class="fas @(showNewPassword ? "fa-eye-slash" : "fa-eye")"></i>
                </button>
            </div>
            <small class="form-text text-muted">
                Password must be at least 8 characters long
            </small>
        </div>

        <div class="mb-3">
            <label for="confirmPassword" class="form-label">Confirm New Password</label>
            <div class="password-input-container">
                <InputText id="confirmPassword"
                           type="@(showConfirmPassword ? "text" : "password")"
                           class="form-control"
                           @bind-Value="securityModel.ConfirmPassword"
                           placeholder="Confirm new password" />
                <button type="button" class="password-toggle-btn"
                        @onclick="@(() => showConfirmPassword = !showConfirmPassword)">
                    <i class="fas @(showConfirmPassword ? "fa-eye-slash" : "fa-eye")"></i>
                </button>
            </div>
        </div>

        <div class="security-section mb-4">
            <h5 class="mb-3">Two-Factor Authentication</h5>
            <div class="form-check">
                <InputCheckbox id="twoFactor" class="form-check-input"
                               @bind-Value="securityModel.EnableTwoFactor" />
                <label class="form-check-label" for="twoFactor">
                    Enable Two-Factor Authentication
                </label>
            </div>
            <small class="form-text text-muted">
                Add an extra layer of security to your account
            </small>
        </div>

        <button type="submit" class="btn btn-success settings-btn">
            Update Security Settings
        </button>
    </EditForm>
</div>

@code {
    private SecurityModel securityModel = new();

    private bool showCurrentPassword;
    private bool showNewPassword;
    private bool showConfirmPassword;

    private void HandleSecuritySubmit()
    {
        if (securityModel.NewPassword != securityModel.ConfirmPassword)
        {
            Console.WriteLine("Passwords do not match!");
            return;
        }

        Console.WriteLine("Security settings updated");
        // TODO: Call backend to change password & 2FA
    }

    private class SecurityModel
    {
        public string CurrentPassword { get; set; } = string.Empty;
        public string NewPassword     { get; set; } = string.Empty;
        public string ConfirmPassword { get; set; } = string.Empty;
        public bool   EnableTwoFactor { get; set; } = false;
    }
}